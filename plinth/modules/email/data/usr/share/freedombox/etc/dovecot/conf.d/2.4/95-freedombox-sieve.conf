# Do not edit this file. Manage your settings on FreedomBox.

# Default sieve scripts applied for delivery to all users. To move mail to Junk
# folder based on classification headers set by rspamd. See:
# https://doc.dovecot.org/main/core/plugins/sieve.html

sieve_script freedombox-after {
  type = after
  driver = file
  path = /etc/dovecot/freedombox-sieve-after
}

sieve_plugins {
  sieve_imapsieve = yes
  sieve_extprograms = yes
}

sieve_global_extensions {
  vnd.dovecot.pipe = yes
  vnd.dovecot.environment = yes
}

# Make rspamd learn spam/ham when the user marks mails as junk or not junk.
# https://doc.dovecot.org/main/core/config/spam_reporting.html
sieve_pipe_bin_dir = /usr/bin

# When moving a mail from to Junk folder from elsewhere
mailbox Junk {
  sieve_script learn-spam {
    type = before
    cause = copy
    path = /etc/dovecot/freedombox-sieve/learn-spam.sieve
  }
}

# When moving a mail from from Junk folder to elsewhere
imapsieve_from Junk {
  sieve_script learn-ham {
    type = before
    cause = copy
    path = /etc/dovecot/freedombox-sieve/learn-ham.sieve
  }
}
