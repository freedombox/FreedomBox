##
## On all sites, provide cockpit on the path: /_cockpit/
##
## Requires the following Apache modules to be enabled:
##   mod_headers
##   mod_proxy
##   mod_proxy_http
##   mod_proxy_wstunnel
##
<Location /_cockpit/>
    # Redirect to HTTPS in case of not already using it. This can happen since
    # we don't redirect for .onion domains.
    RewriteEngine on
    ReWriteCond %{HTTPS} !=on
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=302,L]

    ProxyPass http://localhost:9090/_cockpit/
</Location>

<Location /_cockpit/cockpit/socket>
    ProxyPass ws://localhost:9090/_cockpit/socket
</Location>
